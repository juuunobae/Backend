# Stream
- 어떤 스트림 가능한 소스로 부터 핸들러에게 해당 데이터를 여러개의 작은 chunks로 나누어 보내주는 형태의 구현체
- 데이터가 흐르는 관 같은 것
- 대용량 데이터와 비동기적으로만 얻을 수 있는 데이터를 다룰 때 유용한 데이터 구조
- 자유자재로 연결할 수 있는 형태의 데이터 구조
- 파일에서 읽어 오는 스트림
  - 용량이 큰 영상 파일 등
- 네트워크에서 읽어 오는 스트림
  - 네트워크 인풋 등
  - TCP 소켓과 같이 언제 데이터가 올 지 모르는 경우
- 메모리 측면에서 buffer로 데이터를 처리하는 것보다 훨씬 유리하게 작동한다.
  - buffer는 해당 데이터를 통째로 메모리에 올려놓고 순서대로 처리하기 때문에 처리가 끝날 때 까지 buffer를 내려 놓을 수 없어 메모리를 많이 차지하는 반면, stream은 아주 작게 쪼개놓은 chunk들을 개별로 메모리에서 올려서 처리하기 때문에 메모리를 차지하는 비율이 적다.

## 처리시 유의점
### 어디에서 chunk가 잘릴지 예측할 수 없다.
- 예상하지 못하게 chunk가 쪼개지면 원하는 값을 얻지 못할 수 도 있다.

## 일반적인 구현 형태
```js

    const fs = require('fs')
    const rs = fs.createReadStram('file.txt', {
        encoding: 'utf-8',
        // 인코딩을 지정하면 data를 string으로 받을 수 있다.
    })

    rs.on('data', data => {
        ...
    })

    rs.on('error', error => {
        ...
    })

    rs.on('end', () => {
        ...
    })

```
- data, error, end 등의 이벤트 핸들러를 달아 처리한다.
- 특별히 지정하지 않으면 data는 buffer가 된다.

## stream의 종류
### Readable
- 읽어낼 수 있는 스트림
  - fs.createReadStream
  - process.stdin 
    - 표준 입력에서 오는 스트림
  - 서버 입장의 HTTP 요청 
    - 클라이언트가 요청한 스트림
  - 클라이언트 입장의 HTTP 응답
    - 서버로 부터 돌아온 응답의 스트림

### Writable
- 출력할 수 있는 스트림
  - fs.createWriteStream
  - process.stdin 
    - 표준 입력에서 오는 스트림
  - 서버 입장의 HTTP 응답
    - 클라이언트에게 응답하는 스트림
  - 클라이언트 입장의 HTTP 요청
    - 서버로 요청하는 스트림

### Duplex
- 입력을 받을 수도 있고 출력을 보낼 수도 있다
  - TCP sockets
    - 네트워크를 통해서 입력을 받거나 출력을 보내야 할 때의 양방향 스트림
  - zlib streams
    - 압축을 위한 데이터를 요청받고 응답 받기 위해 입력과 출력을 할 때의 스트림
  - crypto stream
    - 암호화 알고리즘 등이 들어있는 모듈
    - 어떠한 데이터를 암호화, 복호화를 위해 입력과 출력을 해야 할 때의 스트림
  
### Transform
- 입력받은 스트림을 변환해 새로운 스트림으로 만든다.
- 입력과 다른 형태로 바뀌어서 출력되는 경우
  - zlib streams
  - crypto stream

## pipline
- transform 스트림을 쉽게 활용하게 도와준다.
- 연속된 스트림을 받아서 중간에 들어오는 transform 스트림을 거쳐서 출력 스트림으로 보내는 일련의 흐름을 하나로 묶어주는 함수